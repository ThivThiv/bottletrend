<div class="section">
  <div class="container">
  <h1>Acheter une bouteille</h1>
    <div class="card-bottle-photo">
      <%= @batch.photo.attached? ? cl_image_tag(@batch.photo.key, height: 150, width: 50, crop: :fill) : image_tag("https://images.unsplash.com/photo-1520732770642-f4d947ca9653?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=815&q=80", width: 50, heigth: 50, crop: :fill) %>
      <div class="card-bottle-description">
        <div class="price-trend">
        <%# Que si domaine stock > 0 %>
          <h2> <strong>Prix:</strong> <%= @batch.current_price %>â‚¬</h2>
          <div class="domain-card-trend">
            <p><i class="fa-solid fa-arrow-trend-up"></i></p>
          </div>
        </div>
        <br>
        <p><strong>Stock initial : </strong> <%= @batch.quantity %></p>
        <% if @batch.available_domain_stock.positive? %>
          <p><strong>Stock</strong> : <%= @batch.available_domain_stock %> (Domaine)</p>
        <% else %>
          <p><strong>Stock</strong> : <%= @batch.available_users_stock %> (Utilisateurs)</p>
        <% end %>
        <p><strong>AnnÃ©e:</strong> : <%= @batch.year %></p>
        <p><strong>Potentiel : </strong> <%= @batch.potential %>/5</p>
      </div>
    </div>

    <div data-controller="max-quantity" data-max-quantity-domain-value="<%= @batch.available_domain_stock %>" data-max-quantity-users-value="<%= @batch.available_users_stock %>">
      <%= simple_form_for([@batch, @transaction]) do |f| %>
        <%= f.input :quantity, input_html: { data: { max_quantity_target: :input,  action: "keyup->max-quantity#available"} } %>
        <div class="flash flash-danger alert-dismissible fade show d-none" role="alert" data-max-quantity-target="alert">
          <span><strong>Oops!</strong> ðŸ˜± Not enough stock available.</span>
        </div>

        <div class="btn btn-jaune" style="padding: 0px 3px;" role="button" data-disable-button-target="button">
          <%= f.button :submit, "Acheter", input_html: { data: { disable_button_target: "button", action: "input->disable-button#disable"} } %>
        </div>
      <% end %>
    </div>
  </div>
</div>
